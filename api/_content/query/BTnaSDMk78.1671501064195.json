[{"_path":"/plugins/queue/lmtp","_dir":"queue","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"queue/lmtp - Deliver mail to the local MTA","description":"Haraka queue/lmtp plugin - Deliver mail to the local MTA","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"queuelmtp-plugin"},"children":[{"type":"text","value":"queue/lmtp plugin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plugin delivers inbound mail via LMTP."}]},{"type":"element","tag":"h2","props":{"id":"configuration"},"children":[{"type":"text","value":"Configuration"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"LMTP is enabled by adding "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"queue/lmtp"}]},{"type":"text","value":" to config/plugins. LMTP delivery is configured in "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"config/lmtp.ini"}]},{"type":"text","value":" . By default, all inbound messages are forwarded to the host specified in the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"[main]"}]},{"type":"text","value":" section. Domain specific routes can be specified by creating additional sections with the same host/port or path options."}]},{"type":"element","tag":"h3","props":{"id":"lmtpini"},"children":[{"type":"text","value":"lmtp.ini"}]},{"type":"element","tag":"code","props":{"code":"; defaults\nhost=localhost\nport=24\n\n[example1.com]\n; Goes elsewhere\nhost=10.1.1.1\nport=2400\n\n[example2.com]\n; Using unix domain sockets\npath = /tmp/blah_com_socket\n","language":"ini"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"; defaults\nhost=localhost\nport=24\n\n[example1.com]\n; Goes elsewhere\nhost=10.1.1.1\nport=2400\n\n[example2.com]\n; Using unix domain sockets\npath = /tmp/blah_com_socket\n"}]}]}]}]},"navigation":{"title":"queue/lmtp"},"_type":"markdown","_id":"content:8.plugins:queue:lmtp.md","_source":"content","_file":"8.plugins/queue/lmtp.md","_extension":"md"},{"_path":"/plugins/queue/quarantine","_dir":"queue","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"quarantine - Quarantine mail","description":"Haraka quarantine plugin - Quarantine mail","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"quarantine-plugin"},"children":[{"type":"text","value":"quarantine plugin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plugin will save a message (in message/rfc822 format) to a specified\ndirectory, which will be created automatically if it does not already exist,\na dated sub-folder is also added to the end of the path specified in YYYYMMDD\nformat."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It is designed to be used by other plugins which request the message be\nquarantined by setting a connection or transaction note that this plugin\nchecks."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"NOTE: this plugin simply saves a copy of the message.  It does not reject or\ndiscard the message and relies on another plugin to perform this function."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It uses the 'queue' hook, so that it runs after all the 'data_post' plugins\nand should be listed in 'config/plugins' to run before your queue hooks that\nperform actual deliveries."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To ensure that only completely written files are present in the quarantine,\nthe files are written to a temporary directory first and then hardlinked to\nthe final destination before the temporary file is deleted."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The temporary directory is 'quarantine_path/tmp' which defaults to:\n/var/spool/haraka/quarantine/tmp."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Upon start-up, any files present in the temporary directory are deleted\nsyncronously prior to any messages being accepted."}]},{"type":"element","tag":"h2","props":{"id":"configuration"},"children":[{"type":"text","value":"Configuration"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This plugin looks for 'quarantine.ini' in the config directory."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"quarantine_path                   (default: /var/spool/haraka/quarantine)"},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"The default base path to save the quarantine files to.  It will be created\nif it does not already exist."}]}]},{"type":"element","tag":"h2","props":{"id":"usage"},"children":[{"type":"text","value":"Usage"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you wish to keep a copy of the message in your plugin, simply either:"}]},{"type":"element","tag":"code","props":{"code":"connection.notes.quarantine = [ 1 | true | 'sub/directory/path' ];\n","language":"javascript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"connection.notes.quarantine = [ 1 | true | 'sub/directory/path' ];\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"or"}]},{"type":"element","tag":"code","props":{"code":"connection.transaction.notes.quarantine = [ 1 | true | 'sub/directory/path' ];\n","language":"javascript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"connection.transaction.notes.quarantine = [ 1 | true | 'sub/directory/path' ];\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"e.g."}]},{"type":"element","tag":"code","props":{"code":"connection.notes.quarantine = 1;\n","language":"javascript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"connection.notes.quarantine = 1;\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"would save the message to '/var/spool/quarantine/haraka/YYYYMMDD/UUID' where\nYYYMMDD and UUID are expanded to current date and transaction UUID."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"and"}]},{"type":"element","tag":"code","props":{"code":"connection.notes.quarantine = 'corpus';\n","language":"javascript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"connection.notes.quarantine = 'corpus';\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"would save the message to '/var/spool/quarantine/haraka/corpus/YYYYMMDD/UUID'."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note: you can specify 'corpus/foo' or 'corpus/foo/bar' and the directories will\nbe automatically created.  Do not add any leading or trailing slashes."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default - after the message is quarantined, the plugin will tell Haraka to\ncontinue to the next plugin.  You can specify a different action like DENY or\nOK and supply an optional message using the following notes:"}]},{"type":"element","tag":"code","props":{"code":"connection.notes.quarantine_action = [ OK, 'Message quarantined' ];\nconnection.transaction.notes.quarantine_action = [ DENY, 'Message rejected' ];\n","language":"javascript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"connection.notes.quarantine_action = [ OK, 'Message quarantined' ];\nconnection.transaction.notes.quarantine_action = [ DENY, 'Message rejected' ];\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you don't want to supply a specific message back to the client you can\nalso just specify a return code:"}]},{"type":"element","tag":"code","props":{"code":"connection.notes.quarantine_action = OK;\nconnection.transaction.notes.quarantine_action = DENY;\n","language":"javascript"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"connection.notes.quarantine_action = OK;\nconnection.transaction.notes.quarantine_action = DENY;\n"}]}]}]}]},"navigation":{"title":"quarantine"},"_type":"markdown","_id":"content:8.plugins:queue:quarantine.md","_source":"content","_file":"8.plugins/queue/quarantine.md","_extension":"md"}]